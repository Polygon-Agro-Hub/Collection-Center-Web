<app-loading-spinner *ngIf="isLoading" />

<div class="flex flex-row items-center gap-5 font-semibold text[#424242] dark:text-white mb-4 mr-5 ml-0 cursor-pointer">
  <p>Assign</p>
  <!-- <p>Officer Reports</p>  -->
</div>

<div class="w-full px-10 py-7 bg-tileLight dark:bg-[#363636] rounded-lg mb-0">
  <div class="flex flex-col gap-2 items-center justify-center">
    <p class="text-lg font-semibold text-[#292929] mx-3 dark:text-[#FFFFFF]">
      All Orders()
    </p>
    <p class="text-nrmal font-semibold text-[#292929] mx-3 dark:text-[#FFFFFF]">
      Daily Target for <span class="text-[#415CFF]">{{this.currentDate}}</span>
    </p>
    
  </div>
</div>


<div *ngIf="!isLoading" class="h-screen py-8">

 <div class="w-full px-10 py-7 bg-tileLight dark:bg-tileBlack rounded-lg mt-0 mb-8">
        <div class="overflow-x-auto mt-8 mr-5 border-gray-100 border-[2px] rounded-lg">
            <table class="w-full divide-y-2 overflow-hidden">
                <thead class=" dark:bg-[#272F45] text-[#4B5563] dark:text-gray-300">
                    <tr>
                        <th class="px-6 py-3 text-left font-medium">No</th>
                        <th class="px-6 py-3 text-left font-medium">EMP ID</th>
                        <th class="px-6 py-3 text-left font-medium">Full Name</th>
                        <th class="px-6 py-3 text-left font-medium">No of Orders</th>

                    </tr>
                </thead>
                <tbody class="bg-white dark:bg-[#1E293B]">
                    <tr *ngFor="let item of assignedOrdersArr; let i = index">
                      <td class="px-6 py-4 text-sm text-[#000000] font-medium dark:text-gray-300">
                        {{ (i + 1) < 10 ? '0' + (i + 1) : i + 1 }}
                      </td>
                      <td class="px-6 py-4 text-sm text-[#000000] font-medium dark:text-gray-300">{{ item.empId }}</td>
                      <td class="px-6 py-4 text-sm text-[#000000] font-medium dark:text-gray-300">{{ item.fullName }}</td>
                      <td class="px-6 py-4 text-sm text-[#000000] font-medium dark:text-gray-300"> 
                        <input
                          type="number"
                          [(ngModel)]="item.count"
                          (ngModelChange)="validateTotalCount()"
                          min="0"
                          class="border-[#415CFF] border-[2px] border-dotted rounded-lg w-20 px-2 py-1 text-center"
                        />
                      </td>
                    </tr>
                  
                    <!-- Total Orders Row Below "No of Orders" Column -->
                    <tr class="text-sm">
                      <td></td> <!-- Empty cell for 'No' -->
                      <td></td> <!-- Empty cell for 'EMP ID' -->
                      <td class="px-6 py-2 text-right text-[#000000] dark:text-gray-300 font-bold">Total:</td>
                      <td class="px-6 py-4 text-sm text-gray-900 dark:text-gray-300">
                        <input
                          type="number"
                          [value]="totalAssignedOrders"
                          readonly
                          class="border-[#415CFF] border-[2px] border-dotted rounded-lg w-20 px-2 py-1 text-center text-gray-900 dark:text-gray-300 bg-white dark:bg-[#1E293B]"
                        />
                        <i *ngIf="isCountValid" class="fa-solid fa-circle-check text-blue-600 ml-2 text-lg"></i>
                      </td>
                    </tr>
                  
                    <!-- Validation Message Row -->
                    <tr *ngIf="!isCountValid" class="text-red-500 text-sm">
                      <td colspan="4" class="px-6 py-2 text-center">
                        Total assigned orders should equal to total orders ({{ totalOrders }}).
                      </td>
                    </tr>
                  </tbody>
            </table>
        </div>

        <div class="flex flex-row justify-center items-center my-7 gap-8">
            <button class="bg-[#FFFFFF] text-[#6B7D8C] border-[2px] border-[#95A1AC] rounded-lg px-5 py-2"
                (click)="onCancel()">
                Cancel
            </button>
            <button class="rounded-lg px-7 py-2"
                [ngClass]="(isCountValid && totalOrders !== 0) ? 'bg-[#415CFF] text-[#FFFFFF]' : 'bg-[#95A1AC] text-[#6B7D8C]'"
                (click)="isCountValid && onSubmit()"
                [disabled]="!isCountValid || totalOrders === 0">
                Save
            </button>
        </div>

    </div>


</div>
<!-- WHERE po.isTargetAssigned = false AND po.status = 'Processing'; -->